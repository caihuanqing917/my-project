<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Áü≥Â§¥Ââ™ÂàÄÂ∏ÉÊ∏∏Êàè</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Arial', sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            display: flex;
            justify-content: center;
            align-items: center;
            padding: 20px;
        }

        .game-container {
            background: white;
            border-radius: 20px;
            box-shadow: 0 20px 40px rgba(0, 0, 0, 0.1);
            padding: 30px;
            max-width: 600px;
            width: 100%;
            text-align: center;
        }

        h1 {
            color: #333;
            margin-bottom: 20px;
            font-size: 2.5rem;
            font-weight: bold;
        }

        .audio-controls {
            display: flex;
            justify-content: center;
            gap: 15px;
            margin-bottom: 20px;
        }

        .audio-btn {
            background: #6c757d;
            color: white;
            border: none;
            border-radius: 20px;
            padding: 8px 16px;
            font-size: 0.9rem;
            cursor: pointer;
            transition: all 0.3s ease;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
        }

        .audio-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.2);
        }

        .audio-btn.music-on {
            background: linear-gradient(135deg, #28a745 0%, #20c997 100%);
        }

        .audio-btn.music-off {
            background: #dc3545;
            opacity: 0.7;
        }

        .audio-btn.sound-on {
            background: linear-gradient(135deg, #007bff 0%, #6610f2 100%);
        }

        .audio-btn.sound-off {
            background: #dc3545;
            opacity: 0.7;
        }

        .score-board {
            background: #f8f9fa;
            border-radius: 15px;
            padding: 20px;
            margin-bottom: 30px;
        }

        .score {
            display: flex;
            justify-content: space-around;
            font-size: 1.2rem;
            font-weight: bold;
            color: #333;
        }

        .game-area {
            display: flex;
            justify-content: space-around;
            align-items: center;
            margin-bottom: 40px;
            gap: 20px;
        }

        .player-area, .computer-area {
            flex: 1;
        }

        .choice-display {
            font-size: 4rem;
            margin: 10px 0;
            min-height: 100px;
            display: flex;
            align-items: center;
            justify-content: center;
            background: #f8f9fa;
            border-radius: 15px;
            border: 3px solid #e9ecef;
            transition: all 0.3s ease;
        }

        .choice-display.winner {
            border-color: #28a745;
            background: #d4edda;
            transform: scale(1.1);
        }

        .choice-display.loser {
            border-color: #dc3545;
            background: #f8d7da;
        }

        .vs {
            font-size: 2rem;
            font-weight: bold;
            color: #666;
            flex: 0 0 auto;
        }

        .controls {
            display: flex;
            justify-content: center;
            gap: 20px;
            margin-bottom: 30px;
            flex-wrap: wrap;
        }

        .choice-btn {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border: none;
            border-radius: 15px;
            padding: 20px;
            font-size: 1rem;
            cursor: pointer;
            transition: all 0.3s ease;
            min-width: 120px;
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 10px;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.2);
        }

        .choice-btn:hover {
            transform: translateY(-3px);
            box-shadow: 0 8px 25px rgba(0, 0, 0, 0.3);
        }

        .choice-btn:active {
            transform: translateY(-1px);
        }

        .choice-btn .emoji {
            font-size: 2rem;
        }

        .result-area {
            margin-top: 20px;
        }

        .result-message {
            font-size: 1.5rem;
            font-weight: bold;
            margin-bottom: 20px;
            min-height: 40px;
            display: flex;
            align-items: center;
            justify-content: center;
            padding: 15px;
            border-radius: 10px;
            transition: all 0.3s ease;
        }

        .result-message.win {
            background: #d4edda;
            color: #155724;
            border: 2px solid #28a745;
        }

        .result-message.lose {
            background: #f8d7da;
            color: #721c24;
            border: 2px solid #dc3545;
        }

        .result-message.tie {
            background: #fff3cd;
            color: #856404;
            border: 2px solid #ffc107;
        }

        .reset-btn {
            background: #dc3545;
            color: white;
            border: none;
            border-radius: 10px;
            padding: 15px 30px;
            font-size: 1rem;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .reset-btn:hover {
            background: #c82333;
            transform: translateY(-2px);
        }

        @media (max-width: 768px) {
            .game-container {
                margin: 10px;
                padding: 20px;
            }

            h1 {
                font-size: 2rem;
            }

            .audio-controls {
                gap: 10px;
                margin-bottom: 15px;
            }

            .audio-btn {
                padding: 6px 12px;
                font-size: 0.8rem;
            }

            .game-area {
                flex-direction: column;
                gap: 10px;
            }

            .vs {
                order: 2;
                font-size: 1.5rem;
            }

            .choice-display {
                font-size: 3rem;
                min-height: 80px;
            }

            .controls {
                gap: 10px;
            }

            .choice-btn {
                min-width: 100px;
                padding: 15px;
            }
        }
    </style>
</head>
<body>
    <div class="game-container">
        <h1>Áü≥Â§¥Ââ™ÂàÄÂ∏ÉÊ∏∏Êàè</h1>

        <div class="audio-controls">
            <button id="music-toggle" class="audio-btn music-on" title="ÂàáÊç¢ËÉåÊôØÈü≥‰πê">
                üéµ Èü≥‰πê
            </button>
            <button id="sound-toggle" class="audio-btn sound-on" title="ÂàáÊç¢Èü≥Êïà">
                üîä Èü≥Êïà
            </button>
        </div>

        <div class="score-board">
            <div class="score">
                <span>ÊÇ®ÁöÑÂæóÂàÜ: <span id="player-score">0</span></span>
                <span>ÁîµËÑëÂæóÂàÜ: <span id="computer-score">0</span></span>
            </div>
        </div>

        <div class="game-area">
            <div class="player-area">
                <h3>ÊÇ®ÁöÑÈÄâÊã©</h3>
                <div id="player-choice" class="choice-display">‚ùì</div>
            </div>

            <div class="vs">VS</div>

            <div class="computer-area">
                <h3>ÁîµËÑëÈÄâÊã©</h3>
                <div id="computer-choice" class="choice-display">‚ùì</div>
            </div>
        </div>

        <div class="controls">
            <button class="choice-btn" data-choice="rock">
                <span class="emoji">ü™®</span>
                <span>Áü≥Â§¥</span>
            </button>
            <button class="choice-btn" data-choice="paper">
                <span class="emoji">üìÑ</span>
                <span>Â∏É</span>
            </button>
            <button class="choice-btn" data-choice="scissors">
                <span class="emoji">‚úÇÔ∏è</span>
                <span>Ââ™ÂàÄ</span>
            </button>
        </div>

        <div class="result-area">
            <div id="result-message" class="result-message"></div>
            <button id="reset-btn" class="reset-btn">ÈáçÊñ∞ÂºÄÂßã</button>
        </div>
    </div>

    <script>
        // Èü≥È¢ëÁÆ°ÁêÜÁ±ª
        class AudioManager {
            constructor() {
                this.audioContext = null;
                this.backgroundMusic = null;
                this.isMusicPlaying = false;
                this.soundEnabled = true;
                this.musicEnabled = true;
                this.initAudioContext();
            }

            // ÂàùÂßãÂåñÈü≥È¢ë‰∏ä‰∏ãÊñá
            initAudioContext() {
                try {
                    this.audioContext = new (window.AudioContext || window.webkitAudioContext)();
                } catch (error) {
                    console.warn('Web Audio API not supported:', error);
                }
            }

            // ÂàõÂª∫ÁÆÄÂçïÁöÑÈü≥Ë∞É
            createTone(frequency, duration, type = 'sine', volume = 0.3) {
                if (!this.audioContext || !this.soundEnabled) return;

                const oscillator = this.audioContext.createOscillator();
                const gainNode = this.audioContext.createGain();

                oscillator.connect(gainNode);
                gainNode.connect(this.audioContext.destination);

                oscillator.type = type;
                oscillator.frequency.setValueAtTime(frequency, this.audioContext.currentTime);

                gainNode.gain.setValueAtTime(0, this.audioContext.currentTime);
                gainNode.gain.linearRampToValueAtTime(volume, this.audioContext.currentTime + 0.01);
                gainNode.gain.exponentialRampToValueAtTime(0.01, this.audioContext.currentTime + duration);

                oscillator.start(this.audioContext.currentTime);
                oscillator.stop(this.audioContext.currentTime + duration);
            }

            // Êí≠ÊîæÁÇπÂáªÈü≥Êïà
            playClickSound() {
                this.createTone(800, 0.1, 'square', 0.2);
            }

            // Êí≠ÊîæËÉúÂà©Èü≥Êïà
            playWinSound() {
                // ËÉúÂà©Èü≥Êïà - ‰∏äÂçáÁöÑÈü≥Ë∞É
                setTimeout(() => this.createTone(523, 0.2, 'sine', 0.3), 0);    // C
                setTimeout(() => this.createTone(659, 0.2, 'sine', 0.3), 200);  // E
                setTimeout(() => this.createTone(784, 0.3, 'sine', 0.3), 400);  // G
            }

            // Êí≠ÊîæÂ§±Ë¥•Èü≥Êïà
            playLoseSound() {
                // Â§±Ë¥•Èü≥Êïà - ‰∏ãÈôçÁöÑÈü≥Ë∞É
                this.createTone(400, 0.5, 'sawtooth', 0.3);
            }

            // Êí≠ÊîæÂπ≥Â±ÄÈü≥Êïà
            playTieSound() {
                this.createTone(600, 0.3, 'triangle', 0.2);
            }

            // Êí≠ÊîæÊ∏∏ÊàèÁªìÊùüÈü≥Êïà
            playGameOverSound(isWin) {
                if (isWin) {
                    // ËÉúÂà©Â∫ÜÁ•ùÈü≥Êïà
                    for (let i = 0; i < 5; i++) {
                        setTimeout(() => {
                            this.createTone(523 + i * 100, 0.2, 'sine', 0.3);
                        }, i * 150);
                    }
                } else {
                    // Â§±Ë¥•Èü≥Êïà
                    this.createTone(200, 1, 'sawtooth', 0.3);
                }
            }

            // ÁÆÄÂçïÁöÑËÉåÊôØÈü≥‰πêÔºàÂæ™ÁéØÈü≥Ë∞ÉÔºâ
            startBackgroundMusic() {
                if (!this.audioContext || !this.musicEnabled || this.isMusicPlaying) return;

                this.isMusicPlaying = true;
                this.playBackgroundLoop();
            }

            playBackgroundLoop() {
                if (!this.isMusicPlaying || !this.musicEnabled) return;

                // ÁÆÄÂçïÁöÑÊóãÂæãÂæ™ÁéØ
                const melody = [523, 587, 659, 698, 784, 698, 659, 587]; // CÂ§ßË∞ÉÈü≥Èò∂

                melody.forEach((frequency, index) => {
                    setTimeout(() => {
                        if (this.isMusicPlaying && this.musicEnabled) {
                            this.createTone(frequency, 0.5, 'sine', 0.1);
                        }
                    }, index * 600);
                });

                // Âæ™ÁéØÊí≠Êîæ
                if (this.isMusicPlaying && this.musicEnabled) {
                    setTimeout(() => {
                        this.playBackgroundLoop();
                    }, melody.length * 600);
                }
            }

            // ÂÅúÊ≠¢ËÉåÊôØÈü≥‰πê
            stopBackgroundMusic() {
                this.isMusicPlaying = false;
            }

            // ÂàáÊç¢Èü≥Êïà
            toggleSounds() {
                this.soundEnabled = !this.soundEnabled;
                return this.soundEnabled;
            }

            // ÂàáÊç¢ËÉåÊôØÈü≥‰πê
            toggleMusic() {
                this.musicEnabled = !this.musicEnabled;
                if (this.musicEnabled && !this.isMusicPlaying) {
                    this.startBackgroundMusic();
                } else if (!this.musicEnabled) {
                    this.stopBackgroundMusic();
                }
                return this.musicEnabled;
            }
        }

        // ÂàõÂª∫ÂÖ®Â±ÄÈü≥È¢ëÁÆ°ÁêÜÂô®ÂÆû‰æã
        const audioManager = new AudioManager();

        // Ê∏∏ÊàèÁä∂ÊÄÅ
        let playerScore = 0;
        let computerScore = 0;

        // Ê∏∏ÊàèÈÄâÈ°π
        const choices = {
            rock: { emoji: 'ü™®', name: 'Áü≥Â§¥' },
            paper: { emoji: 'üìÑ', name: 'Â∏É' },
            scissors: { emoji: '‚úÇÔ∏è', name: 'Ââ™ÂàÄ' }
        };

        // DOM ÂÖÉÁ¥†
        const playerScoreElement = document.getElementById('player-score');
        const computerScoreElement = document.getElementById('computer-score');
        const playerChoiceElement = document.getElementById('player-choice');
        const computerChoiceElement = document.getElementById('computer-choice');
        const resultMessageElement = document.getElementById('result-message');
        const choiceButtons = document.querySelectorAll('.choice-btn');
        const resetButton = document.getElementById('reset-btn');
        const musicToggle = document.getElementById('music-toggle');
        const soundToggle = document.getElementById('sound-toggle');

        // ÂàùÂßãÂåñÊ∏∏Êàè
        function initGame() {
            // ‰∏∫ÊØè‰∏™ÈÄâÊã©ÊåâÈíÆÊ∑ªÂä†ÁÇπÂáª‰∫ã‰ª∂
            choiceButtons.forEach(button => {
                button.addEventListener('click', () => {
                    const playerChoice = button.dataset.choice;
                    audioManager.playClickSound(); // Êí≠ÊîæÁÇπÂáªÈü≥Êïà
                    playRound(playerChoice);
                });
            });

            // ÈáçÁΩÆÊåâÈíÆ‰∫ã‰ª∂
            resetButton.addEventListener('click', () => {
                audioManager.playClickSound();
                resetGame();
            });

            // Èü≥È¢ëÊéßÂà∂ÊåâÈíÆ‰∫ã‰ª∂
            musicToggle.addEventListener('click', () => {
                audioManager.playClickSound();
                const isMusicOn = audioManager.toggleMusic();
                updateMusicButton(isMusicOn);
            });

            soundToggle.addEventListener('click', () => {
                // ÂÖàÊí≠ÊîæÈü≥ÊïàÂÜçÂàáÊç¢Áä∂ÊÄÅÔºåËøôÊ†∑Áî®Êà∑ËÉΩÂê¨Âà∞Ëøô‰∏™ÁÇπÂáª
                audioManager.playClickSound();
                setTimeout(() => {
                    const isSoundOn = audioManager.toggleSounds();
                    updateSoundButton(isSoundOn);
                }, 100);
            });

            // ÂàùÂßãÂåñÈü≥È¢ëÊéßÂà∂ÊåâÈíÆÁä∂ÊÄÅ
            updateMusicButton(audioManager.musicEnabled);
            updateSoundButton(audioManager.soundEnabled);

            // ÂàùÂßãÂåñÊòæÁ§∫
            updateScore();
            showMessage('ÈÄâÊã©ÊÇ®ÁöÑÂá∫ÊãõÔºÅ', '');

            // ÂêØÂä®ËÉåÊôØÈü≥‰πê
            setTimeout(() => {
                audioManager.startBackgroundMusic();
            }, 1000);
        }

        // Êõ¥Êñ∞Èü≥‰πêÊåâÈíÆÁä∂ÊÄÅ
        function updateMusicButton(isOn) {
            if (isOn) {
                musicToggle.className = 'audio-btn music-on';
                musicToggle.innerHTML = 'üéµ Èü≥‰πê';
            } else {
                musicToggle.className = 'audio-btn music-off';
                musicToggle.innerHTML = 'üîá Èü≥‰πê';
            }
        }

        // Êõ¥Êñ∞Èü≥ÊïàÊåâÈíÆÁä∂ÊÄÅ
        function updateSoundButton(isOn) {
            if (isOn) {
                soundToggle.className = 'audio-btn sound-on';
                soundToggle.innerHTML = 'üîä Èü≥Êïà';
            } else {
                soundToggle.className = 'audio-btn sound-off';
                soundToggle.innerHTML = 'üîá Èü≥Êïà';
            }
        }

        // Áé©‰∏ÄËΩÆÊ∏∏Êàè
        function playRound(playerChoice) {
            // Á¶ÅÁî®ÊåâÈíÆÈò≤Ê≠¢ÈáçÂ§çÁÇπÂáª
            disableButtons();

            // ÁîüÊàêÁîµËÑëÈÄâÊã©
            const computerChoice = getComputerChoice();

            // ÊòæÁ§∫ÈÄâÊã©
            showChoices(playerChoice, computerChoice);

            // Ê∑ªÂä†‰∏Ä‰∏™Áü≠ÊöÇÁöÑÂª∂Ëøü‰ª•Â¢ûÂä†ÊÇ¨Âøµ
            setTimeout(() => {
                // Âà§Êñ≠ËÉúË¥ü
                const result = determineWinner(playerChoice, computerChoice);

                // Êí≠ÊîæÁªìÊûúÈü≥Êïà
                playResultSound(result);

                // Êõ¥Êñ∞ÂàÜÊï∞
                updateScoreBasedOnResult(result);

                // ÊòæÁ§∫ÁªìÊûú
                showResult(result, playerChoice, computerChoice);

                // ÈáçÊñ∞ÂêØÁî®ÊåâÈíÆ
                enableButtons();
            }, 1000);
        }

        // Êí≠ÊîæÁªìÊûúÈü≥Êïà
        function playResultSound(result) {
            switch (result) {
                case 'win':
                    audioManager.playWinSound();
                    break;
                case 'lose':
                    audioManager.playLoseSound();
                    break;
                case 'tie':
                    audioManager.playTieSound();
                    break;
            }
        }

        // Ëé∑ÂèñÁîµËÑëÈÄâÊã©
        function getComputerChoice() {
            const choiceArray = Object.keys(choices);
            const randomIndex = Math.floor(Math.random() * choiceArray.length);
            return choiceArray[randomIndex];
        }

        // ÊòæÁ§∫ÈÄâÊã©
        function showChoices(playerChoice, computerChoice) {
            playerChoiceElement.textContent = choices[playerChoice].emoji;

            // ÁîµËÑëÈÄâÊã©Ê∑ªÂä†Âä®ÁîªÊïàÊûú
            let counter = 0;
            const animationInterval = setInterval(() => {
                const randomChoice = getComputerChoice();
                computerChoiceElement.textContent = choices[randomChoice].emoji;
                counter++;

                if (counter >= 10) {
                    clearInterval(animationInterval);
                    computerChoiceElement.textContent = choices[computerChoice].emoji;
                }
            }, 100);
        }

        // Âà§Êñ≠ËÉúË¥ü
        function determineWinner(playerChoice, computerChoice) {
            if (playerChoice === computerChoice) {
                return 'tie';
            }

            const winConditions = {
                rock: 'scissors',
                paper: 'rock',
                scissors: 'paper'
            };

            if (winConditions[playerChoice] === computerChoice) {
                return 'win';
            } else {
                return 'lose';
            }
        }

        // Ê†πÊçÆÁªìÊûúÊõ¥Êñ∞ÂàÜÊï∞
        function updateScoreBasedOnResult(result) {
            if (result === 'win') {
                playerScore++;
            } else if (result === 'lose') {
                computerScore++;
            }
            updateScore();
        }

        // Êõ¥Êñ∞ÂàÜÊï∞ÊòæÁ§∫
        function updateScore() {
            playerScoreElement.textContent = playerScore;
            computerScoreElement.textContent = computerScore;
        }

        // ÊòæÁ§∫ÁªìÊûú
        function showResult(result, playerChoice, computerChoice) {
            const playerName = choices[playerChoice].name;
            const computerName = choices[computerChoice].name;

            let message = '';
            let className = '';

            switch (result) {
                case 'win':
                    message = `üéâ ÊÇ®Ëµ¢‰∫ÜÔºÅ${playerName} ÂáªË¥• ${computerName}`;
                    className = 'win';
                    // Ê∑ªÂä†ËÉúÂà©ÊïàÊûú
                    playerChoiceElement.classList.add('winner');
                    computerChoiceElement.classList.add('loser');
                    break;
                case 'lose':
                    message = `üòî ÊÇ®Ëæì‰∫ÜÔºÅ${computerName} ÂáªË¥• ${playerName}`;
                    className = 'lose';
                    // Ê∑ªÂä†Â§±Ë¥•ÊïàÊûú
                    playerChoiceElement.classList.add('loser');
                    computerChoiceElement.classList.add('winner');
                    break;
                case 'tie':
                    message = `ü§ù Âπ≥Â±ÄÔºÅÈÉΩÈÄâÊã©‰∫Ü${playerName}`;
                    className = 'tie';
                    break;
            }

            showMessage(message, className);

            // Ê£ÄÊü•ÊòØÂê¶Êúâ‰∫∫ÁéáÂÖàËææÂà∞5ÂàÜ
            if (playerScore >= 5 || computerScore >= 5) {
                setTimeout(() => {
                    showGameOver();
                }, 2000);
            }
        }

        // ÊòæÁ§∫Ê∂àÊÅØ
        function showMessage(message, className) {
            resultMessageElement.textContent = message;
            resultMessageElement.className = `result-message ${className}`;
        }

        // Ê∏∏ÊàèÁªìÊùü
        function showGameOver() {
            let finalMessage = '';
            const isPlayerWin = playerScore >= 5;

            if (isPlayerWin) {
                finalMessage = 'üèÜ ÊÅ≠ÂñúÔºÅÊÇ®Ëé∑Âæó‰∫ÜÊúÄÁªàËÉúÂà©ÔºÅ';
                showMessage(finalMessage, 'win');
                audioManager.playGameOverSound(true);
            } else {
                finalMessage = 'üíª ÁîµËÑëËé∑Âæó‰∫ÜÊúÄÁªàËÉúÂà©ÔºÅÂÜçËØï‰∏ÄÊ¨°ÂêßÔºÅ';
                showMessage(finalMessage, 'lose');
                audioManager.playGameOverSound(false);
            }

            disableButtons();
        }

        // ÈáçÁΩÆÊ∏∏Êàè
        function resetGame() {
            playerScore = 0;
            computerScore = 0;

            updateScore();

            playerChoiceElement.textContent = '‚ùì';
            computerChoiceElement.textContent = '‚ùì';

            // Ê∏ÖÈô§ÊâÄÊúâÊïàÊûúÁ±ª
            playerChoiceElement.className = 'choice-display';
            computerChoiceElement.className = 'choice-display';

            showMessage('ÈÄâÊã©ÊÇ®ÁöÑÂá∫ÊãõÔºÅ', '');

            enableButtons();
        }

        // Á¶ÅÁî®ÊåâÈíÆ
        function disableButtons() {
            choiceButtons.forEach(button => {
                button.disabled = true;
                button.style.opacity = '0.6';
                button.style.cursor = 'not-allowed';
            });
        }

        // ÂêØÁî®ÊåâÈíÆ
        function enableButtons() {
            choiceButtons.forEach(button => {
                button.disabled = false;
                button.style.opacity = '1';
                button.style.cursor = 'pointer';
            });
        }

        // È°µÈù¢Âä†ËΩΩÂÆåÊàêÂêéÂàùÂßãÂåñÊ∏∏Êàè
        document.addEventListener('DOMContentLoaded', initGame);
    </script>
</body>
</html>