<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>çŸ³å¤´å‰ªåˆ€å¸ƒæ¸¸æˆ</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Arial', sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            display: flex;
            justify-content: center;
            align-items: center;
            padding: 20px;
        }

        .game-container {
            background: white;
            border-radius: 20px;
            box-shadow: 0 20px 40px rgba(0, 0, 0, 0.1);
            padding: 30px;
            max-width: 600px;
            width: 100%;
            text-align: center;
        }

        h1 {
            color: #333;
            margin-bottom: 20px;
            font-size: 2.5rem;
            font-weight: bold;
        }

        .audio-controls {
            display: flex;
            justify-content: center;
            gap: 15px;
            margin-bottom: 20px;
        }

        .audio-btn {
            background: #6c757d;
            color: white;
            border: none;
            border-radius: 20px;
            padding: 8px 16px;
            font-size: 0.9rem;
            cursor: pointer;
            transition: all 0.3s ease;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
        }

        .audio-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.2);
        }

        .audio-btn.music-on {
            background: linear-gradient(135deg, #28a745 0%, #20c997 100%);
        }

        .audio-btn.music-off {
            background: #dc3545;
            opacity: 0.7;
        }

        .audio-btn.sound-on {
            background: linear-gradient(135deg, #007bff 0%, #6610f2 100%);
        }

        .audio-btn.sound-off {
            background: #dc3545;
            opacity: 0.7;
        }

        .score-board {
            background: #f8f9fa;
            border-radius: 15px;
            padding: 20px;
            margin-bottom: 30px;
        }

        .score {
            display: flex;
            justify-content: space-around;
            font-size: 1.2rem;
            font-weight: bold;
            color: #333;
        }

        .game-area {
            display: flex;
            justify-content: space-around;
            align-items: center;
            margin-bottom: 40px;
            gap: 20px;
        }

        .player-area, .computer-area {
            flex: 1;
        }

        .choice-display {
            font-size: 4rem;
            margin: 10px 0;
            min-height: 100px;
            display: flex;
            align-items: center;
            justify-content: center;
            background: #f8f9fa;
            border-radius: 15px;
            border: 3px solid #e9ecef;
            transition: all 0.3s ease;
        }

        .choice-display.winner {
            border-color: #28a745;
            background: #d4edda;
            transform: scale(1.1);
        }

        .choice-display.loser {
            border-color: #dc3545;
            background: #f8d7da;
        }

        .vs {
            font-size: 2rem;
            font-weight: bold;
            color: #666;
            flex: 0 0 auto;
        }

        .controls {
            display: flex;
            justify-content: center;
            gap: 20px;
            margin-bottom: 30px;
            flex-wrap: wrap;
        }

        .choice-btn {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border: none;
            border-radius: 15px;
            padding: 20px;
            font-size: 1rem;
            cursor: pointer;
            transition: all 0.3s ease;
            min-width: 120px;
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 10px;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.2);
        }

        .choice-btn:hover {
            transform: translateY(-3px);
            box-shadow: 0 8px 25px rgba(0, 0, 0, 0.3);
        }

        .choice-btn:active {
            transform: translateY(-1px);
        }

        .choice-btn .emoji {
            font-size: 2rem;
        }

        .result-area {
            margin-top: 20px;
        }

        .result-message {
            font-size: 1.5rem;
            font-weight: bold;
            margin-bottom: 20px;
            min-height: 40px;
            display: flex;
            align-items: center;
            justify-content: center;
            padding: 15px;
            border-radius: 10px;
            transition: all 0.3s ease;
        }

        .result-message.win {
            background: #d4edda;
            color: #155724;
            border: 2px solid #28a745;
        }

        .result-message.lose {
            background: #f8d7da;
            color: #721c24;
            border: 2px solid #dc3545;
        }

        .result-message.tie {
            background: #fff3cd;
            color: #856404;
            border: 2px solid #ffc107;
        }

        .reset-btn {
            background: #dc3545;
            color: white;
            border: none;
            border-radius: 10px;
            padding: 15px 30px;
            font-size: 1rem;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .reset-btn:hover {
            background: #c82333;
            transform: translateY(-2px);
        }

        @media (max-width: 768px) {
            .game-container {
                margin: 10px;
                padding: 20px;
            }

            h1 {
                font-size: 2rem;
            }

            .audio-controls {
                gap: 10px;
                margin-bottom: 15px;
            }

            .audio-btn {
                padding: 6px 12px;
                font-size: 0.8rem;
            }

            .game-area {
                flex-direction: column;
                gap: 10px;
            }

            .vs {
                order: 2;
                font-size: 1.5rem;
            }

            .choice-display {
                font-size: 3rem;
                min-height: 80px;
            }

            .controls {
                gap: 10px;
            }

            .choice-btn {
                min-width: 100px;
                padding: 15px;
            }
        }
    </style>
</head>
<body>
    <div class="game-container">
        <h1>çŸ³å¤´å‰ªåˆ€å¸ƒæ¸¸æˆ</h1>

        <div class="audio-controls">
            <button id="music-toggle" class="audio-btn music-on" title="åˆ‡æ¢èƒŒæ™¯éŸ³ä¹">
                ğŸµ éŸ³ä¹
            </button>
            <button id="sound-toggle" class="audio-btn sound-on" title="åˆ‡æ¢éŸ³æ•ˆ">
                ğŸ”Š éŸ³æ•ˆ
            </button>
        </div>

        <div class="score-board">
            <div class="score">
                <span>æ‚¨çš„å¾—åˆ†: <span id="player-score">0</span></span>
                <span>ç”µè„‘å¾—åˆ†: <span id="computer-score">0</span></span>
            </div>
        </div>

        <div class="game-area">
            <div class="player-area">
                <h3>æ‚¨çš„é€‰æ‹©</h3>
                <div id="player-choice" class="choice-display">â“</div>
            </div>

            <div class="vs">VS</div>

            <div class="computer-area">
                <h3>ç”µè„‘é€‰æ‹©</h3>
                <div id="computer-choice" class="choice-display">â“</div>
            </div>
        </div>

        <div class="controls">
            <button class="choice-btn" data-choice="rock">
                <span class="emoji">ğŸª¨</span>
                <span>çŸ³å¤´</span>
            </button>
            <button class="choice-btn" data-choice="paper">
                <span class="emoji">ğŸ“„</span>
                <span>å¸ƒ</span>
            </button>
            <button class="choice-btn" data-choice="scissors">
                <span class="emoji">âœ‚ï¸</span>
                <span>å‰ªåˆ€</span>
            </button>
        </div>

        <div class="result-area">
            <div id="result-message" class="result-message"></div>
            <button id="reset-btn" class="reset-btn">é‡æ–°å¼€å§‹</button>
        </div>
    </div>

    <script>
        // éŸ³é¢‘ç®¡ç†ç±»
        class AudioManager {
            constructor() {
                this.audioContext = null;
                this.backgroundMusic = null;
                this.isMusicPlaying = false;
                this.soundEnabled = true;
                this.musicEnabled = true;
                this.initAudioContext();
            }

            // åˆå§‹åŒ–éŸ³é¢‘ä¸Šä¸‹æ–‡
            initAudioContext() {
                try {
                    this.audioContext = new (window.AudioContext || window.webkitAudioContext)();
                } catch (error) {
                    console.warn('Web Audio API not supported:', error);
                }
            }

            // åˆ›å»ºç®€å•çš„éŸ³è°ƒ
            createTone(frequency, duration, type = 'sine', volume = 0.3) {
                if (!this.audioContext || !this.soundEnabled) return;

                const oscillator = this.audioContext.createOscillator();
                const gainNode = this.audioContext.createGain();

                oscillator.connect(gainNode);
                gainNode.connect(this.audioContext.destination);

                oscillator.type = type;
                oscillator.frequency.setValueAtTime(frequency, this.audioContext.currentTime);

                gainNode.gain.setValueAtTime(0, this.audioContext.currentTime);
                gainNode.gain.linearRampToValueAtTime(volume, this.audioContext.currentTime + 0.01);
                gainNode.gain.exponentialRampToValueAtTime(0.01, this.audioContext.currentTime + duration);

                oscillator.start(this.audioContext.currentTime);
                oscillator.stop(this.audioContext.currentTime + duration);
            }

            // æ’­æ”¾ç‚¹å‡»éŸ³æ•ˆ
            playClickSound() {
                this.createTone(800, 0.1, 'square', 0.2);
            }

            // æ’­æ”¾èƒœåˆ©éŸ³æ•ˆ
            playWinSound() {
                // èƒœåˆ©éŸ³æ•ˆ - ä¸Šå‡çš„éŸ³è°ƒ
                setTimeout(() => this.createTone(523, 0.2, 'sine', 0.3), 0);    // C
                setTimeout(() => this.createTone(659, 0.2, 'sine', 0.3), 200);  // E
                setTimeout(() => this.createTone(784, 0.3, 'sine', 0.3), 400);  // G
            }

            // æ’­æ”¾å¤±è´¥éŸ³æ•ˆ
            playLoseSound() {
                // å¤±è´¥éŸ³æ•ˆ - ä¸‹é™çš„éŸ³è°ƒ
                this.createTone(400, 0.5, 'sawtooth', 0.3);
            }

            // æ’­æ”¾å¹³å±€éŸ³æ•ˆ
            playTieSound() {
                this.createTone(600, 0.3, 'triangle', 0.2);
            }

            // æ’­æ”¾æ¸¸æˆç»“æŸéŸ³æ•ˆ
            playGameOverSound(isWin) {
                if (isWin) {
                    // èƒœåˆ©åº†ç¥éŸ³æ•ˆ
                    for (let i = 0; i < 5; i++) {
                        setTimeout(() => {
                            this.createTone(523 + i * 100, 0.2, 'sine', 0.3);
                        }, i * 150);
                    }
                } else {
                    // å¤±è´¥éŸ³æ•ˆ
                    this.createTone(200, 1, 'sawtooth', 0.3);
                }
            }

            // ç®€å•çš„èƒŒæ™¯éŸ³ä¹ï¼ˆå¾ªç¯éŸ³è°ƒï¼‰
            startBackgroundMusic() {
                if (!this.audioContext || !this.musicEnabled || this.isMusicPlaying) return;

                this.isMusicPlaying = true;
                this.playBackgroundLoop();
            }

            playBackgroundLoop() {
                if (!this.isMusicPlaying || !this.musicEnabled) return;

                // ç®€å•çš„æ—‹å¾‹å¾ªç¯
                const melody = [523, 587, 659, 698, 784, 698, 659, 587]; // Cå¤§è°ƒéŸ³é˜¶

                melody.forEach((frequency, index) => {
                    setTimeout(() => {
                        if (this.isMusicPlaying && this.musicEnabled) {
                            this.createTone(frequency, 0.5, 'sine', 0.1);
                        }
                    }, index * 600);
                });

                // å¾ªç¯æ’­æ”¾
                if (this.isMusicPlaying && this.musicEnabled) {
                    setTimeout(() => {
                        this.playBackgroundLoop();
                    }, melody.length * 600);
                }
            }

            // åœæ­¢èƒŒæ™¯éŸ³ä¹
            stopBackgroundMusic() {
                this.isMusicPlaying = false;
            }

            // åˆ‡æ¢éŸ³æ•ˆ
            toggleSounds() {
                this.soundEnabled = !this.soundEnabled;
                return this.soundEnabled;
            }

            // åˆ‡æ¢èƒŒæ™¯éŸ³ä¹
            toggleMusic() {
                this.musicEnabled = !this.musicEnabled;
                if (this.musicEnabled && !this.isMusicPlaying) {
                    this.startBackgroundMusic();
                } else if (!this.musicEnabled) {
                    this.stopBackgroundMusic();
                }
                return this.musicEnabled;
            }
        }

        // åˆ›å»ºå…¨å±€éŸ³é¢‘ç®¡ç†å™¨å®ä¾‹
        const audioManager = new AudioManager();

        // æ¸¸æˆçŠ¶æ€
        let playerScore = 0;
        let computerScore = 0;

        // æ¸¸æˆé€‰é¡¹
        const choices = {
            rock: { emoji: 'ğŸª¨', name: 'çŸ³å¤´' },
            paper: { emoji: 'ğŸ“„', name: 'å¸ƒ' },
            scissors: { emoji: 'âœ‚ï¸', name: 'å‰ªåˆ€' }
        };

        // DOM å…ƒç´ 
        const playerScoreElement = document.getElementById('player-score');
        const computerScoreElement = document.getElementById('computer-score');
        const playerChoiceElement = document.getElementById('player-choice');
        const computerChoiceElement = document.getElementById('computer-choice');
        const resultMessageElement = document.getElementById('result-message');
        const choiceButtons = document.querySelectorAll('.choice-btn');
        const resetButton = document.getElementById('reset-btn');
        const musicToggle = document.getElementById('music-toggle');
        const soundToggle = document.getElementById('sound-toggle');

        // åˆå§‹åŒ–æ¸¸æˆ
        function initGame() {
            // ä¸ºæ¯ä¸ªé€‰æ‹©æŒ‰é’®æ·»åŠ ç‚¹å‡»äº‹ä»¶
            choiceButtons.forEach(button => {
                button.addEventListener('click', () => {
                    const playerChoice = button.dataset.choice;
                    audioManager.playClickSound(); // æ’­æ”¾ç‚¹å‡»éŸ³æ•ˆ
                    playRound(playerChoice);
                });
            });

            // é‡ç½®æŒ‰é’®äº‹ä»¶
            resetButton.addEventListener('click', () => {
                audioManager.playClickSound();
                resetGame();
            });

            // éŸ³é¢‘æ§åˆ¶æŒ‰é’®äº‹ä»¶
            musicToggle.addEventListener('click', () => {
                audioManager.playClickSound();
                const isMusicOn = audioManager.toggleMusic();
                updateMusicButton(isMusicOn);
            });

            soundToggle.addEventListener('click', () => {
                // å…ˆæ’­æ”¾éŸ³æ•ˆå†åˆ‡æ¢çŠ¶æ€ï¼Œè¿™æ ·ç”¨æˆ·èƒ½å¬åˆ°è¿™ä¸ªç‚¹å‡»
                audioManager.playClickSound();
                setTimeout(() => {
                    const isSoundOn = audioManager.toggleSounds();
                    updateSoundButton(isSoundOn);
                }, 100);
            });

            // åˆå§‹åŒ–éŸ³é¢‘æ§åˆ¶æŒ‰é’®çŠ¶æ€
            updateMusicButton(audioManager.musicEnabled);
            updateSoundButton(audioManager.soundEnabled);

            // åˆå§‹åŒ–æ˜¾ç¤º
            updateScore();
            showMessage('é€‰æ‹©æ‚¨çš„å‡ºæ‹›ï¼', '');

            // å¯åŠ¨èƒŒæ™¯éŸ³ä¹
            setTimeout(() => {
                audioManager.startBackgroundMusic();
            }, 1000);
        }

        // æ›´æ–°éŸ³ä¹æŒ‰é’®çŠ¶æ€
        function updateMusicButton(isOn) {
            if (isOn) {
                musicToggle.className = 'audio-btn music-on';
                musicToggle.innerHTML = 'ğŸµ éŸ³ä¹';
            } else {
                musicToggle.className = 'audio-btn music-off';
                musicToggle.innerHTML = 'ğŸ”‡ éŸ³ä¹';
            }
        }

        // æ›´æ–°éŸ³æ•ˆæŒ‰é’®çŠ¶æ€
        function updateSoundButton(isOn) {
            if (isOn) {
                soundToggle.className = 'audio-btn sound-on';
                soundToggle.innerHTML = 'ğŸ”Š éŸ³æ•ˆ';
            } else {
                soundToggle.className = 'audio-btn sound-off';
                soundToggle.innerHTML = 'ğŸ”‡ éŸ³æ•ˆ';
            }
        }

        // ç©ä¸€è½®æ¸¸æˆ
        function playRound(playerChoice) {
            // ç¦ç”¨æŒ‰é’®é˜²æ­¢é‡å¤ç‚¹å‡»
            disableButtons();

            // ç”Ÿæˆç”µè„‘é€‰æ‹©
            const computerChoice = getComputerChoice();

            // æ˜¾ç¤ºé€‰æ‹©
            showChoices(playerChoice, computerChoice);

            // æ·»åŠ ä¸€ä¸ªçŸ­æš‚çš„å»¶è¿Ÿä»¥å¢åŠ æ‚¬å¿µ
            setTimeout(() => {
                // åˆ¤æ–­èƒœè´Ÿ
                const result = determineWinner(playerChoice, computerChoice);

                // æ’­æ”¾ç»“æœéŸ³æ•ˆ
                playResultSound(result);

                // æ›´æ–°åˆ†æ•°
                updateScoreBasedOnResult(result);

                // æ˜¾ç¤ºç»“æœ
                showResult(result, playerChoice, computerChoice);

                // é‡æ–°å¯ç”¨æŒ‰é’®
                enableButtons();
            }, 1000);
        }

        // æ’­æ”¾ç»“æœéŸ³æ•ˆ
        function playResultSound(result) {
            switch (result) {
                case 'win':
                    audioManager.playWinSound();
                    break;
                case 'lose':
                    audioManager.playLoseSound();
                    break;
                case 'tie':
                    audioManager.playTieSound();
                    break;
            }
        }

        // è·å–ç”µè„‘é€‰æ‹©
        function getComputerChoice() {
            const choiceArray = Object.keys(choices);
            const randomIndex = Math.floor(Math.random() * choiceArray.length);
            return choiceArray[randomIndex];
        }

        // æ˜¾ç¤ºé€‰æ‹©
        function showChoices(playerChoice, computerChoice) {
            playerChoiceElement.textContent = choices[playerChoice].emoji;

            // ç”µè„‘é€‰æ‹©æ·»åŠ åŠ¨ç”»æ•ˆæœ
            let counter = 0;
            const animationInterval = setInterval(() => {
                const randomChoice = getComputerChoice();
                computerChoiceElement.textContent = choices[randomChoice].emoji;
                counter++;

                if (counter >= 10) {
                    clearInterval(animationInterval);
                    computerChoiceElement.textContent = choices[computerChoice].emoji;
                }
            }, 100);
        }

        // åˆ¤æ–­èƒœè´Ÿ
        function determineWinner(playerChoice, computerChoice) {
            if (playerChoice === computerChoice) {
                return 'tie';
            }

            const winConditions = {
                rock: 'scissors',
                paper: 'rock',
                scissors: 'paper'
            };

            if (winConditions[playerChoice] === computerChoice) {
                return 'win';
            } else {
                return 'lose';
            }
        }

        // æ ¹æ®ç»“æœæ›´æ–°åˆ†æ•°
        function updateScoreBasedOnResult(result) {
            if (result === 'win') {
                playerScore++;
            } else if (result === 'lose') {
                computerScore++;
            }
            updateScore();
        }

        // æ›´æ–°åˆ†æ•°æ˜¾ç¤º
        function updateScore() {
            playerScoreElement.textContent = playerScore;
            computerScoreElement.textContent = computerScore;
        }

        // æ˜¾ç¤ºç»“æœ
        function showResult(result, playerChoice, computerChoice) {
            const playerName = choices[playerChoice].name;
            const computerName = choices[computerChoice].name;

            let message = '';
            let className = '';

            switch (result) {
                case 'win':
                    message = `ğŸ‰ æ‚¨èµ¢äº†ï¼${playerName} å‡»è´¥ ${computerName}`;
                    className = 'win';
                    // æ·»åŠ èƒœåˆ©æ•ˆæœ
                    playerChoiceElement.classList.add('winner');
                    computerChoiceElement.classList.add('loser');
                    break;
                case 'lose':
                    message = `ğŸ˜” æ‚¨è¾“äº†ï¼${computerName} å‡»è´¥ ${playerName}`;
                    className = 'lose';
                    // æ·»åŠ å¤±è´¥æ•ˆæœ
                    playerChoiceElement.classList.add('loser');
                    computerChoiceElement.classList.add('winner');
                    break;
                case 'tie':
                    message = `ğŸ¤ å¹³å±€ï¼éƒ½é€‰æ‹©äº†${playerName}`;
                    className = 'tie';
                    break;
            }

            showMessage(message, className);

            // æ£€æŸ¥æ˜¯å¦æœ‰äººç‡å…ˆè¾¾åˆ°5åˆ†
            if (playerScore >= 5 || computerScore >= 5) {
                setTimeout(() => {
                    showGameOver();
                }, 2000);
            }
        }

        // æ˜¾ç¤ºæ¶ˆæ¯
        function showMessage(message, className) {
            resultMessageElement.textContent = message;
            resultMessageElement.className = `result-message ${className}`;
        }

        // æ¸¸æˆç»“æŸ
        function showGameOver() {
            let finalMessage = '';
            const isPlayerWin = playerScore >= 5;

            if (isPlayerWin) {
                finalMessage = 'ğŸ† æ­å–œï¼æ‚¨è·å¾—äº†æœ€ç»ˆèƒœåˆ©ï¼';
                showMessage(finalMessage, 'win');
                audioManager.playGameOverSound(true);
            } else {
                finalMessage = 'ğŸ’» ç”µè„‘è·å¾—äº†æœ€ç»ˆèƒœåˆ©ï¼å†è¯•ä¸€æ¬¡å§ï¼';
                showMessage(finalMessage, 'lose');
                audioManager.playGameOverSound(false);
            }

            disableButtons();
        }

        // é‡ç½®æ¸¸æˆ
        function resetGame() {
            playerScore = 0;
            computerScore = 0;

            updateScore();

            playerChoiceElement.textContent = 'â“';
            computerChoiceElement.textContent = 'â“';

            // æ¸…é™¤æ‰€æœ‰æ•ˆæœç±»
            playerChoiceElement.className = 'choice-display';
            computerChoiceElement.className = 'choice-display';

            showMessage('é€‰æ‹©æ‚¨çš„å‡ºæ‹›ï¼', '');

            enableButtons();
        }

        // ç¦ç”¨æŒ‰é’®
        function disableButtons() {
            choiceButtons.forEach(button => {
                button.disabled = true;
                button.style.opacity = '0.6';
                button.style.cursor = 'not-allowed';
            });
        }

        // å¯ç”¨æŒ‰é’®
        function enableButtons() {
            choiceButtons.forEach(button => {
                button.disabled = false;
                button.style.opacity = '1';
                button.style.cursor = 'pointer';
            });
        }

        // é¡µé¢åŠ è½½å®Œæˆååˆå§‹åŒ–æ¸¸æˆ
        document.addEventListener('DOMContentLoaded', initGame);
    </script>
</body>
</html>